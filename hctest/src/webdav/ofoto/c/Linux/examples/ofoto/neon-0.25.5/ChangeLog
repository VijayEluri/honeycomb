------------------------------------------------------------------------
r847 | joe | 2006-01-20 18:01:52 +0000 (Fri, 20 Jan 2006) | 1 line

Tag release 0.25.5.
------------------------------------------------------------------------
r846 | joe | 2006-01-16 13:58:14 +0000 (Mon, 16 Jan 2006) | 2 lines

Bump for 0.25.5.

------------------------------------------------------------------------
r845 | joe | 2006-01-11 12:58:20 +0000 (Wed, 11 Jan 2006) | 9 lines

Merge r838 from trunk:

Fix build on some AIX systems:

* src/ne_request.c: Include sys/limits.h if available.  Define
LONG_LONG_MAX to LONGLONG_MAX if necessary.

* macros/neon.m4 (LIBNEON_SOURCE_CHECKS): Check for sys/limits.h.

------------------------------------------------------------------------
r844 | joe | 2006-01-11 12:53:07 +0000 (Wed, 11 Jan 2006) | 2 lines

* test/request.c (icy_protocol): Add test case.

------------------------------------------------------------------------
r843 | joe | 2006-01-11 12:46:29 +0000 (Wed, 11 Jan 2006) | 3 lines

* src/ne_request.c (read_status_line): Handle ICY protocol responses
for the time being.

------------------------------------------------------------------------
r841 | joe | 2006-01-10 23:25:14 +0000 (Tue, 10 Jan 2006) | 16 lines

Merge r837, r839, r840 from trunk:

Patch from Stefan KÃ¼ng to fix endless authentication loop if the
authentication fails:

* src/ne_sspi.c, src/ne_sspi.h:
  New public function to tell the lib that an authentication was
  successful.
  Return an error if the authentication is restarted without a
  successful authentication before.
* src/ne_auth.c:
  Call the new public function to tell the library about a successful
  authentication.

* src/ne_auth.c (ah_post_send): Fix non-SSPI build.

------------------------------------------------------------------------
r762 | joe | 2005-11-28 11:04:31 +0000 (Mon, 28 Nov 2005) | 16 lines

Merge r759, r760, r761 from trunk:

* src/ne_openssl.c (ne_ssl_clicert_decrypt): Check that private
key/cert match.

* test/makekeys.sh: Create a PKCS#12 client cert with embedded CA
cert.

* test/Makefile.in (clean): Clean all PKCS#12 certs.

* test/ssl.c (load_client_cert): Load the new cert.

* test/ssl.c (wildcard_init): Update error message now most hostname
commands should work OK.


------------------------------------------------------------------------
r756 | joe | 2005-11-25 00:28:32 +0000 (Fri, 25 Nov 2005) | 8 lines

Merge r746, r754 from trunk:

* src/ne_openssl.c (ne_d2i_uchar): Add typedef.
(ne_ssl_cert_import): Use ne_d2i_uchar as type of second
argument to d2i_x509.

* test/makekeys.sh: Fix new domain extraction for multi-part domains.

------------------------------------------------------------------------
r738 | joe | 2005-10-20 18:58:28 +0100 (Thu, 20 Oct 2005) | 2 lines

Bump to 0.25.4.

------------------------------------------------------------------------
r737 | joe | 2005-10-14 13:55:01 +0100 (Fri, 14 Oct 2005) | 15 lines

Merge r735, r736 from trunk:

GSSAPI fixes for non-MIT Kerberos implementations, from Mikhail
Teterin:

* src/ne_auth.c (clean_session): Pass pointer to gssctx to
gss_delete_sec_context.  Don't release stored gssmech.
(continue_negotiate): Pass sess->gssmech directly to
gss_init_sec_context.
(free_auth): Pass pointer to stored name to gss_release_name.

* test/makekeys.sh: Begin octal escapes with \0; use sed to munge
hostname.  (based on patch by Mikhail Teterin)


------------------------------------------------------------------------
r731 | joe | 2005-10-09 09:21:22 +0100 (Sun, 09 Oct 2005) | 8 lines

Merge r729, r730 from trunk:

* src/ne_request.c [!NE_LFS]: Define NE_OFFT_MAX correctly for
platforms with sizeof(off_t) == sizeof(long long).

* src/ne_private.h (struct ne_session_s): Use 512-byte buffer for
error string.

------------------------------------------------------------------------
r728 | joe | 2005-10-06 09:36:24 +0100 (Thu, 06 Oct 2005) | 8 lines

Merge r718, r719, r721 from trunk:

* doc/ref/iaddr.xml: Fix function name.

* doc/ref/reqopts.xml: Fix parameter type.

* config.hw.in (in_addr_t) [!USE_GETADDRINFO]: Define to unsigned int.

------------------------------------------------------------------------
r727 | joe | 2005-10-06 09:27:29 +0100 (Thu, 06 Oct 2005) | 12 lines

Merge r726 from trunk:

* src/ne_defs.h (NE_BUFSIZ): Define.

* src/ne_request.c (struct ne_request_s): Use NE_BUFSIZ for respbuf
size.
(send_request_body): Use NE_BUFSIZ for buffer.
(ne_print_request_header): Use NE_BUFSIZ for stack buffer.

* src/ne_compress.c (struct ne_decompress_s): Use NE_BUFSIZ for outbuf
size.

------------------------------------------------------------------------
r717 | joe | 2005-09-19 10:15:43 +0100 (Mon, 19 Sep 2005) | 6 lines

Merge r715, r716 from trunk:

* doc/ref/resphdr.xml: Fix typo in element name.

* src/ne_request.h (ne_get_response_header): Fix docco.

------------------------------------------------------------------------
r714 | joe | 2005-09-19 10:12:14 +0100 (Mon, 19 Sep 2005) | 14 lines

Merge r695, r696, r698 from trunk:

* doc/ref/opts.xml: Update for neon 0.25 API.  

* doc/ref/reqopts.xml: Document ne_set_request_expect100.

* doc/ref/opts.xml: Remove ne_set_expect100 documentation.

* doc/manual.xml: Pull in reqopts.xml.

* doc/ref/resphdr.xml: New file; document response header handling.

* doc/manual.xml: Reference it.  

------------------------------------------------------------------------
r700 | joe | 2005-09-17 10:10:51 +0100 (Sat, 17 Sep 2005) | 3 lines

* test/common/tests.h (ONCMP): Print actual/expected strings if other
was NULL.

------------------------------------------------------------------------
r683 | joe | 2005-08-20 09:39:28 +0100 (Sat, 20 Aug 2005) | 2 lines

* macros/neon.m4 (NE_VERSIONS_BUNDLED): Bump to 0.25.3.

------------------------------------------------------------------------
r681 | joe | 2005-08-19 10:40:16 +0100 (Fri, 19 Aug 2005) | 12 lines

Merge r678, r679 from trunk:

* src/ne_socket.c (ne_addr_resolve) [!USE_GETADDRINFO]: Use in_addr_t
not unsigned long for address; fix for LP64 platforms - patch by
Matthew Sanderson.

* macros/neon.m4 (LIBNEON_SOURCE_CHECKS): Add check for in_addr_t.
Fix check for h_errno declaration.

* src/ne_socket.c (INADDR_NONE): Define using in_addr_t if system is
missing the definition.

------------------------------------------------------------------------
r672 | joe | 2005-08-14 18:24:19 +0100 (Sun, 14 Aug 2005) | 16 lines

Merge r652 to r671 from trunk:

* test/Makefile.in (VALGRIND): Update to work with modern valgrind.

* macros/neon.m4 (NE_MACOSX): Disable poll on Darwin.

* NEWS: Add Jiang.

* src/ne_redirect.c (post_send): Code cleanup.

* src/ne_locks.c (ne_lock, ne_unlock): Don't lose the NE_AUTH etc
return code for non-2xx responses.

* test/lock.c (fail_lockauth, no_creds): Add test case.


------------------------------------------------------------------------
r659 | joe | 2005-07-06 21:46:42 +0100 (Wed, 06 Jul 2005) | 1 line

Bump release.
------------------------------------------------------------------------
r658 | joe | 2005-07-06 21:45:12 +0100 (Wed, 06 Jul 2005) | 2 lines

- news for 0.25.2

------------------------------------------------------------------------
r653 | joe | 2005-07-02 12:17:31 +0100 (Sat, 02 Jul 2005) | 19 lines

Merge r637 to r651 from trunk:

* Makefile.in (install-tests): New target.

* configure.in: Add --enable-install-tests to support test suite
installation; only add -no-install to TEST_LDFLAGS if not given.

* test/Makefile.in (install, random.txt): New targets.
(LINK): Use TEST_LDFLAGS.
(ZLIB_HELPERS): Add random.txt.

* test/compress.c (init): Use random.txt in pwd rather than trying to
find NEWS from the srcdir.

* src/ne_xml.c: Omit BOM handling for recent releases of libxml2.

* configure.in: Disable tests-install mode by default.


------------------------------------------------------------------------
r637 | joe | 2005-06-22 14:22:08 +0100 (Wed, 22 Jun 2005) | 5 lines

Merge r635 to r636 from trunk:

* config.hw.in: Really fix the Win32 build.


------------------------------------------------------------------------
r631 | joe | 2005-06-21 11:31:29 +0100 (Tue, 21 Jun 2005) | 3 lines

* src/ne_auth.c (ah_post_send): Print auth_hdr safely.
Remove unused SAFELY macro.

------------------------------------------------------------------------
r629 | joe | 2005-06-21 10:45:52 +0100 (Tue, 21 Jun 2005) | 3 lines

* src/ne_xml.c (end_element): Use NE_DBG_XML debug channel for
consistency.

------------------------------------------------------------------------
r628 | joe | 2005-06-21 07:37:05 +0100 (Tue, 21 Jun 2005) | 2 lines

* macros/neon.m4 (NE_VERSIONS_BUNDLED): Bump to 0.25.1.

------------------------------------------------------------------------
r627 | joe | 2005-06-21 07:32:52 +0100 (Tue, 21 Jun 2005) | 9 lines

* src/ne_compress.c (process_footer): Don't invoke reader callback
with len=0 here as well when end-of-response is really reached.
(do_inflate): Do pass on the reader callback return value.

* test/compress.c (reader): Catch multiple invocations with len=0.
(retry_accept): Reset the reader state.
(reader_abort, compress_abort): New functions.


------------------------------------------------------------------------
r626 | joe | 2005-06-01 10:28:28 +0100 (Wed, 01 Jun 2005) | 2 lines

News so far.

------------------------------------------------------------------------
r625 | joe | 2005-06-01 10:19:15 +0100 (Wed, 01 Jun 2005) | 16 lines

Merge r620 to r624 from trunk:

* src/ne_xml.c (char_data): Tidy up debug message.

* src/ne_xml.c (start_element): Use NE_DBG_XML debug constant.
(ne_xml_parse): Use NE_DBG_XMLPARSE debug constant.

* src/ne_basic.c (ne_get_content_type): Ensure that ->charset is NULL
on exit (Johannes Schneider).

* test/basic.c (content_type): Test that all fields are set.

* src/ne_openssl.c (ne__negotiate_ssl): Replace the cached session
with the new one if they differ; based on patch by Robert Eiglmaier.


------------------------------------------------------------------------
r620 | joe | 2005-05-19 22:11:34 +0100 (Thu, 19 May 2005) | 25 lines

Merge r593 to r619 from trunk:

* neon-config.in: Remove idna support flag.

* src/ne_request.h: Fix nonsensical API requirement.

* src/ne_dates.c (rfc1123_weekdays, short_months): Mark pointers as
const.

* src/ne_string.c (b64_alphabet): Use constant array; eliminate last
sizeof(pointer)'s worth of data section in libneon.

* INSTALL.win32: Update to reference 0.9.7g from confirmation from
David Reid.

* src/ne_auth.c: Fix Windows SSPI build.

* TODO: Credit Vladimir.

* src/ne_request.h (ne_hook_post_send): Clarify when the post_send
hook runs.

* NEWS: Updates.


------------------------------------------------------------------------
r600 | joe | 2005-04-24 19:35:42 +0100 (Sun, 24 Apr 2005) | 6 lines

Merge r599 from trunk:

* macros/neon.m4 (NE_REQUIRE_VERSIONS): New macro, replacing
NEON_REQUIRE.  (NEON_CHECK_VERSION): Just check version against that
reported by 'neon-config --version'; support multiple minor versions.

------------------------------------------------------------------------
r590 | joe | 2005-04-24 11:38:01 +0100 (Sun, 24 Apr 2005) | 2 lines

* macros/neon.m4 (NE_VERSIONS_BUNDLED): Bump to 0.25.0 final.

------------------------------------------------------------------------
r589 | joe | 2005-04-24 11:07:37 +0100 (Sun, 24 Apr 2005) | 5 lines

Merge r587 to r588 from trunk:

* test/stubs.c [!NE_HAVE_ZLIB] (sd_reader): Fix to match prototype.


------------------------------------------------------------------------
r587 | joe | 2005-04-24 09:16:26 +0100 (Sun, 24 Apr 2005) | 10 lines

Merge r583 to r586 from trunk:

* src/Makefile.in (c++.c): Fix to exclude ne_privssl.h too.

* macros/neon.m4 (NEON_WARNINGS): Tweak gcc warnings.

* test/request.c (send_bad_offset): Use an empty file and a negative
offset rather than /dev/null.


------------------------------------------------------------------------
r583 | joe | 2005-04-17 22:30:33 +0100 (Sun, 17 Apr 2005) | 4 lines

Merge r582 from trunk:

* Makefile.in (DIST_HEADERS): Do install ne_xmlreq.h.

------------------------------------------------------------------------
r580 | joe | 2005-04-17 21:55:06 +0100 (Sun, 17 Apr 2005) | 4 lines

Merge r579 from trunk:

* src/ne_stubssl.c (ne_ssl_clicert_name): Match new prototype.

------------------------------------------------------------------------
r576 | joe | 2005-04-17 17:03:14 +0100 (Sun, 17 Apr 2005) | 4 lines

* config.hw.in: Define the correct version macros.

* autogen.sh: Substitute release correctly.

------------------------------------------------------------------------
r575 | joe | 2005-04-17 16:53:31 +0100 (Sun, 17 Apr 2005) | 2 lines

* macros/neon.m4 (NE_VERSIONS_BUNDLED): Bump to 0.25.0-pre1.

------------------------------------------------------------------------
r573 | joe | 2005-04-17 16:30:20 +0100 (Sun, 17 Apr 2005) | 14 lines

Add back ne_compress pre_send hack in leiu of the more risky content
handler changes for 0.25.x:

* src/ne_private.h (ne__reqhook_pre_send): Declare function.

* src/ne_request.c (struct ne_request_s): Add per-request pre_send 
hook list.
(ne__reqhook_pre_send): New function.
(ne_request_destroy): Free per-request pre_send hooks.
(build_request): Run per-request pre_send hooks.

* src/ne_compress.c (gz_pre_send): New function.
(ne_decompress_reader): Register the hook.

------------------------------------------------------------------------
r572 | joe | 2005-04-16 17:37:19 +0100 (Sat, 16 Apr 2005) | 19 lines

Merge r567, r568, r569, r570, r571 from trunk:

* src/ne_request.h: Improve general comments.
(ne_request_dispatch, ne_set_request_expect100): Clarify.
(ne_get_session): Mark as const.

* src/ne_request.c (body_fd_send): Set session error string if seek
fails, per new interface requirement.

* test/request.c (send_bad_offset): New test.

* src/ne_openssl.c (check_identity): Destroy buffer on error path.

* test/request.c (iterate_many): Destroy temp buffer.

* src/ne_openssl.c (check_identity): Destroy buffer on error path.

* src/ne_alloc.c (ne_realloc_ml): Fix realloc tracking.

------------------------------------------------------------------------
r566 | joe | 2005-04-15 01:45:54 +0100 (Fri, 15 Apr 2005) | 2 lines

Tweaks.

------------------------------------------------------------------------
r565 | joe | 2005-04-14 20:07:58 +0100 (Thu, 14 Apr 2005) | 7 lines

Merge r562, r563 from trunk:

* Makefile.in (DIST_HEADERS): Don't try to install non-existant
ne_cookies.h.

* neon-config.in: Fix syntax error.

------------------------------------------------------------------------
r564 | joe | 2005-04-14 20:06:41 +0100 (Thu, 14 Apr 2005) | 2 lines

Updates for 0.25.0 changes.

------------------------------------------------------------------------
r561 | joe | 2005-04-14 19:48:16 +0100 (Thu, 14 Apr 2005) | 22 lines

Merge r553, r554, r558, r559, r560 from trunk:

* src/Makefile.in: Add deps for ne_xmlreq.c.

* macros/neon.m4 (NE_DEFINE_VERSIONS): New macro.
(NE_VERSIONS_BUNDLED): Renamed from NEON_VERSIONS; use
NE_DEFINE_VERSIONS.
(NEON_USE_EXTERNAL): Use NE_DEFINE_VERSIONS.

* configure.in: Use NE_VERSIONS_BUNDLED.

* src/ne_utils.c (ne_version_match): Update for new version macros;
make behaviour and docs match reference documentation.

* test/util-tests.c (versioning): Update for new macros, correct
interface.

* src/ne_ssl.h (ne_ssl_clicert_name): Take const clicert argument.

* src/ne_openssl.c, src/ne_gnutls.c: Adapt likewise.


------------------------------------------------------------------------
r552 | joe | 2005-04-05 11:20:35 +0100 (Tue, 05 Apr 2005) | 2 lines

Create 0.25.x branch.

------------------------------------------------------------------------
r551 | joe | 2005-04-05 11:19:42 +0100 (Tue, 05 Apr 2005) | 2 lines

Update.

------------------------------------------------------------------------
r550 | joe | 2005-04-05 11:19:16 +0100 (Tue, 05 Apr 2005) | 2 lines

* src/ne_request.h: Improve comment wording.

------------------------------------------------------------------------
r549 | joe | 2005-04-05 00:50:26 +0100 (Tue, 05 Apr 2005) | 2 lines

Fix typo.

------------------------------------------------------------------------
r548 | joe | 2005-04-04 21:01:56 +0100 (Mon, 04 Apr 2005) | 2 lines

Updates.

------------------------------------------------------------------------
r547 | joe | 2005-04-04 20:51:33 +0100 (Mon, 04 Apr 2005) | 3 lines

* test/uri-tests.c (leak_authinfo): Remove test; API now clarified
such that current implementation is valid.

------------------------------------------------------------------------
r546 | joe | 2005-04-04 20:50:36 +0100 (Mon, 04 Apr 2005) | 2 lines

* src/ne_uri.h (ne_uri_free, ne_uri_parse): Clarify API.

------------------------------------------------------------------------
r545 | joe | 2005-04-04 20:40:08 +0100 (Mon, 04 Apr 2005) | 4 lines

* src/ne_alloc.c, src/ne_alloc.h (ne_oom_callback): Use a typedef for
the callback argument, to fix warnings with OpenWatcom; patch by
Vitali E. Pelenyov.

------------------------------------------------------------------------
r544 | joe | 2005-04-04 20:34:26 +0100 (Mon, 04 Apr 2005) | 4 lines

* src/ne_request.c (add_fixed_headers): Send "close" token in
Connection header if persistent connections are disabled; patch by Tom
Hoefakker.  Use ne_buffer_czappend throughout.

------------------------------------------------------------------------
r542 | joe | 2005-04-04 18:32:15 +0100 (Mon, 04 Apr 2005) | 6 lines

* test/xmlreq.c: New file.

* test/Makefile.in: Build it.

* test/utils.h: Include child.h.

------------------------------------------------------------------------
r541 | joe | 2005-04-04 18:30:50 +0100 (Mon, 04 Apr 2005) | 8 lines

* src/ne_xmlreq.h (ne_xml_parse_response, ne_xml_dispatch_request):
Specify that session error string is set for XML parse errors.

* src/ne_xmlreq.c (parse_error): New function.
(ne_xml_parse_response): On successful end-of-response, tell
the the XML parser the end of the document is reached.  Use
parse_error() for error handling.

------------------------------------------------------------------------
r540 | joe | 2005-04-04 14:49:25 +0100 (Mon, 04 Apr 2005) | 2 lines

* src/ne_socket.c (ne_service_lookup): Remove function.

------------------------------------------------------------------------
r531 | joe | 2005-03-19 22:30:43 +0000 (Sat, 19 Mar 2005) | 2 lines

* test/request.c: Remove idna_hostname; missed in previous commit.

------------------------------------------------------------------------
r530 | joe | 2005-03-19 22:19:37 +0000 (Sat, 19 Mar 2005) | 7 lines

Avoid use of "read" and "write" since POSIX owns these names and
allows them to be macros.

* src/ne_socket.c (struct iofns): Rename read and write functions to
sread and swrite. 
(ne_sock_read, ne_sock_peek, ne_sock_fullwrite, ne_sock_readline): Synch.

------------------------------------------------------------------------
r529 | joe | 2005-03-19 21:24:27 +0000 (Sat, 19 Mar 2005) | 2 lines

* src/ne_uri.c (uri_paths): Fix URI encoding default.

------------------------------------------------------------------------
r518 | joe | 2005-03-05 09:14:59 +0000 (Sat, 05 Mar 2005) | 11 lines

Remove support for IDNA: IDNA really needs to be done at application
level.

* macros/neon.m4 (NEON_LIBIDN): Remove.

* src/ne_session.c (set_hostinfo): Remove IDNA support.

* src/ne_utils.c, src/ne_utils.h: Don't advertise IDNA feature.

* test/util-tests.c, test/request.c: Remove IDNA tests.

------------------------------------------------------------------------
r517 | joe | 2005-03-03 19:25:11 +0000 (Thu, 03 Mar 2005) | 3 lines

* src/ne_socket.c (NE_ISRESET): Also treat ENOTCONN as a "connection
reset" error.

------------------------------------------------------------------------
r516 | joe | 2005-03-03 19:20:03 +0000 (Thu, 03 Mar 2005) | 3 lines

* macros/neon-xml-parser.m4 (NEON_XML_PARSER): Default to detect
expat; fall back on libxml2.

------------------------------------------------------------------------
r515 | joe | 2005-03-03 19:11:45 +0000 (Thu, 03 Mar 2005) | 3 lines

* macros/neon.m4 (NEON_SSL): Disable GNU TLS support for the 0.25.0
release, since it's not complete yet.

------------------------------------------------------------------------
r512 | joe | 2005-02-28 14:17:09 +0000 (Mon, 28 Feb 2005) | 2 lines

Note string type changes.

------------------------------------------------------------------------
r511 | joe | 2005-02-28 14:16:24 +0000 (Mon, 28 Feb 2005) | 5 lines

Missed in previous commit:

* src/ne_ssl.h (ne_ssl_cert_identity, ne_ssl_cert_name): Define to
return UTF-8 only.

------------------------------------------------------------------------
r510 | joe | 2005-02-28 14:15:59 +0000 (Mon, 28 Feb 2005) | 9 lines

* src/ne_ssl.h (ne_ssl_cert_identity, ne_ssl_cert_name): Define to
return UTF-8 only.

* src/ne_openssl.c (append_dirstring): Factor out from
ne_ssl_readable_dname.  (ne_ssl_readable_dname): Use factored-out
version. (dup_ia5string): New function.
(check_identity): Use append_dirstring to convert commonName
to UTF-8 if necessary; use dup_ia5string.

------------------------------------------------------------------------
r509 | joe | 2005-02-28 14:09:02 +0000 (Mon, 28 Feb 2005) | 9 lines

* src/ne_ssl.h (ne_ssl_cert_identity, ne_ssl_cert_name): Define to
return UTF-8 only.

* src/ne_openssl.c (append_dirstring): Factor out from
ne_ssl_readable_dname.  (ne_ssl_readable_dname): Use factored-out
version. (dup_ia5string): New function.
(check_identity): Use append_dirstring to convert commonName
to UTF-8 if necessary; use dup_ia5string.

------------------------------------------------------------------------
r508 | joe | 2005-02-28 11:54:17 +0000 (Mon, 28 Feb 2005) | 2 lines

* test/xml.c (matches): Test that with-BOM without-prolog also parses.

------------------------------------------------------------------------
r507 | joe | 2005-02-28 11:53:39 +0000 (Mon, 28 Feb 2005) | 3 lines

* src/ne_xml.c (ne_xml_parser_s, ne_xml_parse): Conditionalize BOM
handling to expat <= 1.95.2 and all current versions of libxml2.

------------------------------------------------------------------------
r506 | joe | 2005-02-28 11:07:11 +0000 (Mon, 28 Feb 2005) | 2 lines

* test/compress.c: Fix signedness warning.

------------------------------------------------------------------------
r505 | joe | 2005-02-28 11:03:42 +0000 (Mon, 28 Feb 2005) | 3 lines

* test/socket.c (addr_compare): Fix to pass real raw addresses and
fixed signedness warnings.

------------------------------------------------------------------------
r504 | joe | 2005-02-28 10:54:28 +0000 (Mon, 28 Feb 2005) | 2 lines

Add ne_get_content_type change and reshuffle.

------------------------------------------------------------------------
r503 | joe | 2005-02-28 10:52:09 +0000 (Mon, 28 Feb 2005) | 3 lines

* src/ne_basic.h (ne_get_content_type): Clarify that all fields will
be non-NULL on success.

------------------------------------------------------------------------
r502 | joe | 2005-02-26 19:57:19 +0000 (Sat, 26 Feb 2005) | 2 lines

Note provider-callback error handling API change; fixed bug.

------------------------------------------------------------------------
r501 | joe | 2005-02-26 19:56:24 +0000 (Sat, 26 Feb 2005) | 14 lines


* src/ne_private.h (ne__pull_request_body): Remove prototype.

* src/ne_request.h: Require that request-body-provider callback sets
the session error string if returning errors.

* src/ne_request.c (struct ne_request_s): Remove body_progress field.
(send_request_body): Combine old ne__pull_request_body,
send_request_body and send_with_progress functions into one.  Fix
error handling confusion between provider errors and socket errors;
move NE_RETRY handling here and take a retry flag.  (send_request):
Update to pass retry flag to send_request_body and remove NE_RETRY
handling on errors from same.

------------------------------------------------------------------------
r500 | joe | 2005-02-26 19:24:49 +0000 (Sat, 26 Feb 2005) | 1 line

Ignore ChangeLog
------------------------------------------------------------------------
r499 | joe | 2005-02-26 19:23:52 +0000 (Sat, 26 Feb 2005) | 3 lines

ne_lock_refresh does now DTRT, and D.J.'s cunningly borked proxy
should now be handled.

------------------------------------------------------------------------
r498 | joe | 2005-02-26 19:22:31 +0000 (Sat, 26 Feb 2005) | 6 lines

* src/ne_request.h: Remove EOL definition, namespace violation.

* test/stubs.c, test/lock.c, test/auth.c, src/ne_request.c,
src/ne_request.h, src/ne_props.c, src/ne_acl.c, src/ne_locks.c: Define
EOL.

------------------------------------------------------------------------
r497 | joe | 2005-02-26 19:16:14 +0000 (Sat, 26 Feb 2005) | 3 lines

* src/ne_locks.c (ne_lock_refresh): Always update timeout of passed-in
lock structure, even if new timeout is unknown.

------------------------------------------------------------------------
r496 | joe | 2005-02-26 19:10:19 +0000 (Sat, 26 Feb 2005) | 2 lines

ne_uri_escape escaping rules updated.

------------------------------------------------------------------------
r495 | joe | 2005-02-26 19:09:52 +0000 (Sat, 26 Feb 2005) | 2 lines

* src/ne_uri.h (ne_path_escape): Fix grammar.

------------------------------------------------------------------------
r494 | joe | 2005-02-26 19:02:53 +0000 (Sat, 26 Feb 2005) | 4 lines

* ChangeLog.CVS: Renamed from ChangeLog.

* Makefile.in (ChangeLog): New target.

------------------------------------------------------------------------
r493 | joe | 2005-02-26 18:58:46 +0000 (Sat, 26 Feb 2005) | 2 lines

* macros/neon.m4 (NE_SNPRINTF): Use new trio URL.

------------------------------------------------------------------------
r492 | joe | 2005-02-26 18:57:32 +0000 (Sat, 26 Feb 2005) | 3 lines

* src/ne_socket.c (init_ssl): Call OpenSSL_add_all_algorithms instead
of the specific PKCS12_PBE_add.

------------------------------------------------------------------------
r488 | joe | 2005-02-24 14:42:09 +0000 (Thu, 24 Feb 2005) | 4 lines

* src/ne_auth.c (clean_session, make_gss_error, free_auth): Fixed
signdness mismatch warnings from GSSAPI code; always use unsigned
integers for error codes.

------------------------------------------------------------------------
r483 | joe | 2005-02-24 14:05:44 +0000 (Thu, 24 Feb 2005) | 2 lines

* macros/neon.m4 (NEON_FORMAT): Support type arguments with spaces.

------------------------------------------------------------------------
r481 | joe | 2005-02-14 16:07:35 +0000 (Mon, 14 Feb 2005) | 3 lines

* configure.in: Just AC_DEFINE NEON_IS_LIBRARY; update copyright
notice; be less noisy.

------------------------------------------------------------------------
r480 | joe | 2005-02-14 16:02:58 +0000 (Mon, 14 Feb 2005) | 2 lines

* Makefile.in (clean, subdirs, check): Be less noisy.

------------------------------------------------------------------------
r479 | joe | 2005-02-14 15:43:27 +0000 (Mon, 14 Feb 2005) | 10 lines

* common/tests.c (W): Suppress glibc warn_unused_result annoyance.
(W_RED): New macro.  (child_segv): Use W_RED; do dump core.
(parent_segv): Rename from segv; don't call async-signal-unsafe
fflush(); use W_RED; sleep after kill();
(in_child, main): Install signal handlers for SIGABRT as well
as SIGSEGV.

* common/child.c (server_child, spawn_server_repeat): Suppress glibc
warn_unused_result annoyance; abort if write() fails.

------------------------------------------------------------------------
r477 | joe | 2005-02-11 13:15:22 +0000 (Fri, 11 Feb 2005) | 2 lines

* neon-config.in (--libs): Don't print -L$libdir if $prefix==/usr.

------------------------------------------------------------------------
r464 | joe | 2005-01-27 22:27:26 +0000 (Thu, 27 Jan 2005) | 3 lines

* test/uri-tests.c (leak_authinfo): Add expected-leaky test for
ne_uri_parse leak.

------------------------------------------------------------------------
r463 | joe | 2005-01-27 22:13:10 +0000 (Thu, 27 Jan 2005) | 3 lines

* src/ne_auth.c: Only include ne_private.h for GSSAPI code.
(digest_body): Remove function.

------------------------------------------------------------------------
r462 | joe | 2005-01-27 22:04:44 +0000 (Thu, 27 Jan 2005) | 7 lines

* src/ne_auth.c: Drop qop=auth-int support, sice it is universally
unimplemented by servers and comes with too much baggage.  (struct
auth_challenge): Drop qop_auth_int field.  (digest_challenge,
request_digest, verify_digest_response, auth_challenge, ah_pre_send):
Drop qop=auth-int support.
(auth_body_reader): Remove function.

------------------------------------------------------------------------
r461 | joe | 2005-01-27 21:56:19 +0000 (Thu, 27 Jan 2005) | 2 lines

* src/ne_locks.c (ne_lock): Use ne_xml_dispatch_request.

------------------------------------------------------------------------
r460 | joe | 2005-01-27 21:50:32 +0000 (Thu, 27 Jan 2005) | 1 line

News updates.
------------------------------------------------------------------------
r459 | joe | 2005-01-27 20:05:25 +0000 (Thu, 27 Jan 2005) | 2 lines

* neon.mak: Conditionally enable SSPI support (Vladimir).

------------------------------------------------------------------------
r458 | joe | 2005-01-27 20:04:39 +0000 (Thu, 27 Jan 2005) | 2 lines

* test/cookies.c: Remove file.

------------------------------------------------------------------------
r457 | joe | 2005-01-27 20:03:53 +0000 (Thu, 27 Jan 2005) | 11 lines

Fix SSPI code so that it compiles for Win32 (Vladimir):

* src/ne_sspi.h (ne_sspi_deinit): fixed return type.

* src/ne_sspi.c: Added preprocessor check HAVE_SSPI to allow compilation
without SSPI.
(getMaxTokenSize): removed const qualifier for package parameter because
it has to be passed to a function that takes a not const reference.
(ne_sspi_init, ne_sspi_deinit): Match the function names to the correct
functions.

------------------------------------------------------------------------
r456 | joe | 2005-01-27 20:01:48 +0000 (Thu, 27 Jan 2005) | 2 lines

* neon.mak: Don't build ne_cookies.c (Vladimir).

------------------------------------------------------------------------
r450 | joe | 2005-01-26 16:22:26 +0000 (Wed, 26 Jan 2005) | 2 lines

* src/ne_session.h (ne_set_persist): Clarify lifetime of addrs array.

------------------------------------------------------------------------
r449 | joe | 2005-01-26 14:36:02 +0000 (Wed, 26 Jan 2005) | 7 lines

* src/ne_uri.h (ne_path_escape): Define to percent-encode any
characters barring unreserved and forward-slash.

* src/ne_uri.c (uri_chars): Update to use RF3986 grammar productions.
(path_escape_ch): Replaces ESCAPE.  (ne_path_escape): Clean up, use
new path_escape_ch.

------------------------------------------------------------------------
r448 | joe | 2005-01-26 09:23:36 +0000 (Wed, 26 Jan 2005) | 2 lines

* src/ne_auth.c (get_gss_name): Remove redundant buffer initilization.

------------------------------------------------------------------------
r446 | joe | 2005-01-22 00:00:54 +0000 (Sat, 22 Jan 2005) | 4 lines

* src/ne_request.c (read_message_header, read_response_headers):
Clarify that both functions guarantee to close the connection on
error.

------------------------------------------------------------------------
r445 | joe | 2005-01-21 23:54:36 +0000 (Fri, 21 Jan 2005) | 3 lines

* test/request.c (fail_on_invalid): Test for chunk size overflow and
EOF-at-chunk-size cases.

------------------------------------------------------------------------
r444 | joe | 2005-01-21 23:47:55 +0000 (Fri, 21 Jan 2005) | 3 lines

* test/request.c (fail_on_invalid): Rename from fail_corrupt_chunks;
test for invalid C-L in response.

------------------------------------------------------------------------
r443 | joe | 2005-01-21 23:41:42 +0000 (Fri, 21 Jan 2005) | 4 lines

* src/ne_request.c (ne_begin_request): Reorder message-length logic to
avoid doing unnecessary work.  Fail rather than ignore an invalid
Content-Length response header.

------------------------------------------------------------------------
r442 | joe | 2005-01-21 23:38:57 +0000 (Fri, 21 Jan 2005) | 3 lines

* Makefile.in (cover): Remove all .*da files before running coverage
testing to avoid gcda merge errors.

------------------------------------------------------------------------
r441 | joe | 2005-01-21 17:41:00 +0000 (Fri, 21 Jan 2005) | 1 line

Tweak comment.
------------------------------------------------------------------------
r440 | joe | 2005-01-21 17:28:19 +0000 (Fri, 21 Jan 2005) | 3 lines

* src/ne_request.h (ne_get_response_header,
ne_response_header_iterate): Clarify API guarantees.

------------------------------------------------------------------------
r439 | joe | 2005-01-21 17:23:06 +0000 (Fri, 21 Jan 2005) | 7 lines

Add a response-header iterator interface, needed by OpenOffice:

* src/ne_request.c (struct ne_request_s): Add current_index field.
(ne_response_header_iterate): New function.

* test/request.c (iterate_many, iterate_none): New tests.

------------------------------------------------------------------------
r438 | joe | 2005-01-21 16:28:52 +0000 (Fri, 21 Jan 2005) | 2 lines

* src/ne_request.c (struct field): Remove unused valloc field.

------------------------------------------------------------------------
r437 | joe | 2005-01-21 16:25:12 +0000 (Fri, 21 Jan 2005) | 5 lines

* src/ne_request.c (ne_begin_request): Fix a case where NE_RETRY could
be leaked to the caller if a connection was left open then
ne_set_persist(sess, 0) was called immediately before a request was
sent but suffered a persistent connection timeout.

------------------------------------------------------------------------
r436 | joe | 2005-01-21 16:19:05 +0000 (Fri, 21 Jan 2005) | 5 lines

* src/ne_request.c (HTTP_ERR, HTTP_EXPECT_*): Remove now-unused
macros.  (ne_begin_request, ne_end_request, ne_request_dispatch):
Expand HTTP_ERR usage.


------------------------------------------------------------------------
r435 | joe | 2005-01-21 16:08:53 +0000 (Fri, 21 Jan 2005) | 3 lines

* test/compress.c (tests): retry_notcompress passes since
response-header-handling fixes.

------------------------------------------------------------------------
r434 | joe | 2005-01-21 16:07:05 +0000 (Fri, 21 Jan 2005) | 3 lines

* src/ne_request.c (send_request): Code cleanups, no functional
change.

------------------------------------------------------------------------
r433 | joe | 2005-01-21 16:03:28 +0000 (Fri, 21 Jan 2005) | 2 lines

* src/ne_request.c (ne_request_create): Remove some debugging noise.

------------------------------------------------------------------------
r432 | joe | 2005-01-21 15:59:37 +0000 (Fri, 21 Jan 2005) | 3 lines

* src/ne_request.c (open_connection): Only call ne_close_connection in
ne__negotiate_ssl failure case.

------------------------------------------------------------------------
r431 | joe | 2005-01-21 15:54:26 +0000 (Fri, 21 Jan 2005) | 2 lines

* neon.mak: Build ne_xmlreq.c.

------------------------------------------------------------------------
r430 | joe | 2005-01-20 22:04:23 +0000 (Thu, 20 Jan 2005) | 15 lines

Windows SSPI NTLM/Negotiate implementation from Vladimir Berezniker:

* config.hw.in: Define HAVE_SSPI.

* src/ne_sspi.c, src/ne_sspi.h: New files.

* src/ne_auth.c (auth_scheme): Add new schemes to enum.
[HAVE_SSPI] (auth_session): Add sspi_token, sspi_context fields.
(clean_session): Clean up sspi fields.
(request_sspi, sspi_challenge): New functions.
(auth_challenge, ah_pre_send): Handle Negotiate/NTLM-using-SSPI schemes.

* src/ne_socket.c [HAVE_SSPI] (ne_sock_init, ne_sock_exit):
Initialize/de-initialize SSPI global state.

------------------------------------------------------------------------
r429 | joe | 2005-01-13 19:00:13 +0000 (Thu, 13 Jan 2005) | 2 lines

Reorganise.

------------------------------------------------------------------------
r428 | joe | 2005-01-13 18:53:33 +0000 (Thu, 13 Jan 2005) | 6 lines

Re-drop ne_cookies.[ch], change lost in CVS conversion somehow:

	* ne_cookies.c, ne_cookies.h: Drop cookies support: used old spec
	revision and wasn't very complete anyway.


------------------------------------------------------------------------
r427 | joe | 2005-01-13 18:51:53 +0000 (Thu, 13 Jan 2005) | 2 lines

* test/string-tests.c (append): Test ne_buffer_czappend.

------------------------------------------------------------------------
r426 | joe | 2005-01-13 18:44:00 +0000 (Thu, 13 Jan 2005) | 7 lines

Fixes for some warnings from Solaris cc:

* src/ne_openssl.c (ne_ssl_clicert_read): Pass an int not an unsigned
int to X509_alias_get0.
(ne_ssl_cert_export): Use a char * for the ne_base64 return value to fix
signed-vs-unsigned mismatch.

------------------------------------------------------------------------
r425 | joe | 2005-01-09 13:45:09 +0000 (Sun, 09 Jan 2005) | 2 lines

* src/ne_string.h (ne_buffer_czappend): New macro.

------------------------------------------------------------------------
r424 | joe | 2005-01-09 13:06:22 +0000 (Sun, 09 Jan 2005) | 3 lines

* src/ne_request.c (free_response_headers): Adjust code style, no
functional change.

------------------------------------------------------------------------
r414 | joe | 2005-01-07 15:12:17 +0000 (Fri, 07 Jan 2005) | 6 lines

* src/ne_locks.c (lk_startelm): Set timeout of active lock to
NE_TIMEOUT_INVALID.  (ne_lock_free, ne_lock): Out-of-line NE_FREE.
(ne_lock_refresh): Use ne_xml_dispatch_request; rejig error handling;
really update timeout field of passed-in lock structure if returned
by server.

------------------------------------------------------------------------
r413 | joe | 2005-01-07 00:55:42 +0000 (Fri, 07 Jan 2005) | 4 lines

* src/ne_locks.c (lk_startelm): Only retrive lock-token if not already
known; set session error on abort.
(ne_lock_refresh): Store lock-token in context, simplify error handling.

------------------------------------------------------------------------
r389 | joe | 2005-01-03 10:01:20 +0000 (Mon, 03 Jan 2005) | 3 lines

* macros/neon.m4 (LIBNEON_SOURCE_CHECKS): Only look for gethostbyname
if getaddrinfo is not available.

------------------------------------------------------------------------
r382 | joe | 2005-01-02 13:18:23 +0000 (Sun, 02 Jan 2005) | 4 lines

* macros/neon-xml-parser.m4 (NEON_XML_PARSER, NE_XML_BUNDLED_EXPAT):
Take srcdir, builddir arguments to support VPATH builds correctly.


------------------------------------------------------------------------
r373 | joe | 2004-12-31 17:55:39 +0000 (Fri, 31 Dec 2004) | 4 lines

* src/ne_request.c (read_response_block): Read chunk size lines into
req->respbuf to eliminate the "minimum buffer size" requirement of
ne_read_response_block.

------------------------------------------------------------------------
r372 | joe | 2004-12-31 12:13:22 +0000 (Fri, 31 Dec 2004) | 3 lines

* test/common/tests.h (ONCMP): Fix inverted expected/actual in failure
case.

------------------------------------------------------------------------
r371 | joe | 2004-12-31 12:12:29 +0000 (Fri, 31 Dec 2004) | 7 lines

* src/ne_request.c (free_response_headers): Factor out from
ne_request_destroy.  (ne_request_destroy): Use it.
(ne_begin_request): Free response headers each time the response
is read.

* test/request.c (retry_post_send, reset_headers): New functions.

------------------------------------------------------------------------
r370 | joe | 2004-12-31 11:19:57 +0000 (Fri, 31 Dec 2004) | 3 lines

* src/ne_redirect.c (post_send): C89 compile fix from Vladimir
Berezniker.

------------------------------------------------------------------------
r369 | joe | 2004-12-31 01:36:29 +0000 (Fri, 31 Dec 2004) | 1 line

Docco fix.
------------------------------------------------------------------------
r368 | joe | 2004-12-31 01:11:23 +0000 (Fri, 31 Dec 2004) | 8 lines

* src/ne_auth.c (tokenize): Optionally pass back the separator
character to fix the Negotiate parameter handling.
(auth_challenge): Only grab a Negotiate parameter if the separator
was a space.

* test/auth.c (basic): Test for a Negotiate challenge *without* a
parameter.

------------------------------------------------------------------------
r367 | joe | 2004-12-30 11:55:13 +0000 (Thu, 30 Dec 2004) | 63 lines

Remove callback-based response header handling in favour of
ne_get_response_header interface:

* src/ne_request.h (ne_get_response_header): New function, replacing
ne_add_response_header_handler and ne_add_response_header_catcher.
* src/ne_request.c (struct header_handler): Remove.
(struct field): Add.
(struct ne_request_s): Store a hash of header fields rather than
a hash of callbacks.
(te_hdr_handler, connection_hdr_handler, clength_hdr_handler,
ne_add_response_header_catcher, ne_add_response_header_handler,
ne_duplicate_header, ne_handle_numeric_header):
Remove functions.
(get_response_header_hv, ne_get_response_header, 
add_response_header, remove_response_header): New functions.
(ne_request_create): Don't register the callbacks.
(read_response_headers): Call add_response_header for each
field.
(ne_begin_request): Move handling of Connection, T-E and C-L headers
here.  Comply with 2616/14.10 w.r.t. Connection header handling in
HTTP/1.0 responses.
(ne_request_dispatch): Use ne_discard_response (unrelated).

* src/ne_redirect.c (struct redirect): Remove location field.
(post_send): Adjust to retrieve location header here.

* src/ne_basic.h (ne_get_content_type): Replaces
ne_content_type_handler.

* src/ne_basic.c (dispatch_to_fd): New function.
(get_to_fd, get_lastmodified, clength_hdr_handler, accept_206,
content_range_hdr_handler): Remove functions.
(ne_getmodtime): Adjust to use ne_get_response_header.
(ne_get_range, ne_get, ne_post): Adjust to use dispatch_to_fd.
(ne_get_content_type): Adjust for new API, use ne_get_response_header.
(parse_dav_header, ne_options): Adjust to use ne_get_response_header.

* src/ne_compress.c (struct ne_decompress_s): Add ne_request * field,
remove enchdr field.
(gz_reader): Retrieve C-E header on demand, here.
(ne_decompress_reader, ne_decompress_destroy): Remove C-E response
header duplication.

* src/ne_auth.c (auth_request): Remove auth_hdr, auth_info_hdr
fields.
(ah_collect_header): Remove function.
(ah_create, ah_destroy): Remove response-header callback handling.
(ah_post_send): Retrieve -Authenticate header here; correctly handle
the broken proxy which sends a 401 in response to CONNECT.

* src/ne_locks.c (lk_startelm): Retrieve Lock-Token header here.
(get_ltoken_hdr): Remove function.
(ne_lock, ne_lock_refresh): Remove response-header handling.

* test/basic.c (content_type): Test new interface.

* test/request.c (expect_header_value): Adjust to accept NULL value,
use ne_get_response_header interface.
(multi_header): Test new ne_get_response_header multi-header handling.
(multi_header2, strip_http10_connhdr, strip_http10_connhdr2): New
tests.


------------------------------------------------------------------------
r366 | joe | 2004-12-30 11:38:37 +0000 (Thu, 30 Dec 2004) | 2 lines

* src/ne_compress.c: Debugging message tweaks.

------------------------------------------------------------------------
r365 | joe | 2004-12-30 10:58:08 +0000 (Thu, 30 Dec 2004) | 2 lines

* test/socket.c (peek_expect): Add buffer overflow detection.

------------------------------------------------------------------------
r364 | joe | 2004-12-30 10:51:17 +0000 (Thu, 30 Dec 2004) | 2 lines

* test/common/tests.c (main): Fix build for non-NEON_MEMLEAK.

------------------------------------------------------------------------
r363 | joe | 2004-12-30 10:50:20 +0000 (Thu, 30 Dec 2004) | 3 lines

* test/common/tests.c (main): Print a message for tests which are
marked as T_XLEAKY.

------------------------------------------------------------------------
r362 | joe | 2004-12-30 10:23:00 +0000 (Thu, 30 Dec 2004) | 3 lines

* test/utils.c (any_2xx_request): Destroy the request object even if
failing.

------------------------------------------------------------------------
r361 | joe | 2004-12-30 00:11:53 +0000 (Thu, 30 Dec 2004) | 5 lines

* src/ne_xmlreq.c (ne_xml_parse_response, ne_xml_dispatch_request):
New file, new functions.

* src/Makefile.in (NEON_DAVOBJS): Add ne_xmlreq.*o.

------------------------------------------------------------------------
r360 | joe | 2004-12-24 14:49:02 +0000 (Fri, 24 Dec 2004) | 3 lines

* src/ne_request.c (ne_read_response_to_fd, ne_discard_response): New
functions.

------------------------------------------------------------------------
r359 | joe | 2004-12-13 14:13:27 +0000 (Mon, 13 Dec 2004) | 6 lines

* src/ne_auth.c (auth_challenge): Fix previous commit; stop parsing if
ne_token() reaches end-of-string.

* test/auth.c (negotiate_regress): Add test.


------------------------------------------------------------------------
r358 | joe | 2004-12-09 22:22:26 +0000 (Thu, 09 Dec 2004) | 3 lines

* src/ne_auth.c (auth_challenge): Grab the Negotiate parameter
properly.

------------------------------------------------------------------------
r357 | joe | 2004-12-01 08:42:49 +0000 (Wed, 01 Dec 2004) | 11 lines

From Vladimir Berezniker: update Win32 make file to match the
preprocessor definition changes applied to source code in r256:

* neon.mak:
   OpenSSL: Change NEON_SSL to NE_HAVE_SSL and add a missing HAVE_OPENSSL.
   ZLib: Change NEON_ZLIB to NE_HAVE_ZLIB.
   Expat: Replace NEON_NODAV with NE_HAVE_DAV

* config.hw.in: Discard no longer used USE_DAV_LOCKS.


------------------------------------------------------------------------
r356 | joe | 2004-11-18 10:09:07 +0000 (Thu, 18 Nov 2004) | 11 lines

Win32 build update from Branko Äibej:

Change the Win32 build to compile ZLib from sources, and change the
ZLib versin requirement. This doesn't change neon.mak's external
interface.

* neon.mak: Add parameters and targets for building ZLib from source.

* INSTALL.win32: Update the documentation, and note that the ZLib version
 must be at least 1.2.1.

------------------------------------------------------------------------
r355 | joe | 2004-11-18 09:50:27 +0000 (Thu, 18 Nov 2004) | 5 lines

Win32 build fix from Vladimir Berezniker:

* src/ne_dates.c: Add windows.h to the list of include files to provide
definition of TIME_ZONE_INFORMATION on WIN32 platforms.

------------------------------------------------------------------------
r354 | joe | 2004-11-15 14:47:52 +0000 (Mon, 15 Nov 2004) | 7 lines

Improve OpenSSL error handling, fixing "SSL error: (null)" errors from
interrupted Subversion checkouts over SSL; now reported as
"Interrupted system call" as expected:

* src/ne_socket.c (error_ossl): Always check the OpenSSL error stack
for SSL errors other than SSL_ERROR_ZERO_RETURN.

------------------------------------------------------------------------
r353 | joe | 2004-11-11 14:38:49 +0000 (Thu, 11 Nov 2004) | 3 lines

* test/socket.c (begin) [SOCKET_SSL]: Update to pass third argument to
ne_sock_connect_ssl.

------------------------------------------------------------------------
r352 | joe | 2004-10-31 22:33:28 +0000 (Sun, 31 Oct 2004) | 2 lines

* macros/neon.m4 (NEON_SSL): Require GNU TLS 1.0.22 or later.

------------------------------------------------------------------------
r351 | joe | 2004-10-31 19:17:00 +0000 (Sun, 31 Oct 2004) | 3 lines

* src/ne_openssl.c (ne__negotiate_ssl): Set freechain to fix
certificate chain leak for an SSLv2 connection.

------------------------------------------------------------------------
r350 | joe | 2004-10-31 19:14:47 +0000 (Sun, 31 Oct 2004) | 1 line

Doc fix.
------------------------------------------------------------------------
r349 | joe | 2004-10-31 19:13:43 +0000 (Sun, 31 Oct 2004) | 11 lines

* src/ne_socket.c (ne_sock_connect_ssl): Take a userdata parameter;
attach this as OpenSSL "app data" pointer and GNU TLS "session
pointer".

* src/ne_openssl.c (provide_client_cert): Adapt to use right app data
pointer.  (ne__negotiate_ssl): Pass session pointer to
ne_sock_connect_ssl.

* src/ne_gnutls.c (ne__negotiate_ssl): Pass session pointer to
ne_sock_connect_ssl.

------------------------------------------------------------------------
r348 | joe | 2004-10-31 18:44:31 +0000 (Sun, 31 Oct 2004) | 3 lines

* Makefile.in (uncover, cover): Remove all .*da files before
re-running coverage testing.

------------------------------------------------------------------------
r347 | joe | 2004-10-31 18:43:41 +0000 (Sun, 31 Oct 2004) | 8 lines

Improve ne_socket.c coverage:

* test/socket.c (addr_make_v4, addr_make_v6): Test ne_iaddr_typeof.
(addr_compare): Fix ne_iaddr_cmp tests with v6 addresses.
(expect_close, expect_read): Fix error messages.  (fullread_expect,
line_overflow, line_long_chunked, expect_block_timeout, blocking,
block_timeout): New functions.

------------------------------------------------------------------------
r346 | joe | 2004-10-31 15:03:54 +0000 (Sun, 31 Oct 2004) | 1 line

Doc fix.
------------------------------------------------------------------------
r345 | joe | 2004-10-31 12:15:55 +0000 (Sun, 31 Oct 2004) | 7 lines

* src/ne_compress.c (struct ne_decompress_s): Stop using a union to
decode the gzip header; rename in.buf to header, incount to hdrcount.
(HDR_ID1, HDR_ID2, HDR_CMETH, HDR_FLAGS, HDR_MTIME, HDR_XFLAGS,
HDR_OS): New macros.
(parse_header): Decode the header in-place using new macros.
(gz_reader): Adjust for new field names.

------------------------------------------------------------------------
r344 | joe | 2004-10-31 12:01:06 +0000 (Sun, 31 Oct 2004) | 2 lines

* test/compress.c (do_fetch): Do call ne_decompress_destroy still.

------------------------------------------------------------------------
r343 | joe | 2004-10-31 11:53:35 +0000 (Sun, 31 Oct 2004) | 7 lines

* Makefile.in (uncover): New target.
(cover): Adapt for modern gcc.

* src/Makefile.in (clean): Clean more.

* test/Makefile.in (clean): Clean more.

------------------------------------------------------------------------
r342 | joe | 2004-10-30 12:54:26 +0100 (Sat, 30 Oct 2004) | 3 lines

* src/ne_utils.c (ne_has_support): Avoid a leading 'return 1' without
a case statement when *no* features are supported.

------------------------------------------------------------------------
r339 | joe | 2004-10-30 12:41:53 +0100 (Sat, 30 Oct 2004) | 5 lines

* src/ne_compress.c (ne_decompress_reader) [!HAVE_ZLIB]: Update
for new interface.

* test/stubs.c (stub_decompress): Update for new interface.

------------------------------------------------------------------------
r337 | joe | 2004-10-25 21:17:32 +0100 (Mon, 25 Oct 2004) | 4 lines

Missed in previous commit:

* test/Makefile.in (ZLIB_HELPERS, empty.gz): New helper targets.

------------------------------------------------------------------------
r336 | joe | 2004-10-25 21:12:16 +0100 (Mon, 25 Oct 2004) | 15 lines

Update ne_decompress interface to handle errors by aborting the
response rather than returning errors via ne_decompress_destroy.

* src/ne_compress.c (struct ne_decompress_s): Remove NE_Z_ERROR state.
(parse_header, do_inflate): Don't set error state. 
(gz_reader): Do truncated response handling properly at
end-of-response.  Don't set state to NE_Z_ERROR on error cases, just
return failure and abort the response. 
(ne_decompress_destroy): Return void, do no error handling here.

* test/compress.c (reader): Abort on failure.
(do_fetch): Handle errors returned via ne_request_dispatch rather
than ne_decompress_destroy.
(fail_trailing_1b, fail_empty, notcomp_empty): New tests.

------------------------------------------------------------------------
r335 | joe | 2004-10-25 20:34:34 +0100 (Mon, 25 Oct 2004) | 2 lines

* test/ssl.c (cert_identities): Check the simplest case first.

------------------------------------------------------------------------
r334 | joe | 2004-10-25 20:11:55 +0100 (Mon, 25 Oct 2004) | 5 lines

* src/ne_gnutls.c (ne_ssl_context_trustcert): Fix for GNU TLS 1.0
(Aleix).
(check_certificate): Less debugging noise
(ne__negotiate_ssl): Remove unused variable, tweak debug message.

------------------------------------------------------------------------
r333 | joe | 2004-10-25 10:44:33 +0100 (Mon, 25 Oct 2004) | 3 lines

* src/ne_gnutls.c (check_identity): Fix handling of multiple names in
the subjectAltName extension (per the two_subject_altname2 test).

------------------------------------------------------------------------
r332 | joe | 2004-10-24 21:10:29 +0100 (Sun, 24 Oct 2004) | 1 line

Note that expect100 is now sensible, and that ne_lock_refresh is not.
------------------------------------------------------------------------
r331 | joe | 2004-10-24 18:44:49 +0100 (Sun, 24 Oct 2004) | 4 lines

* src/ne_gnutls.c (check_identity): Return -1 if no CN field found.
(make_peers_chain, check_certificates): New function.
(ne__negotiate_ssl): Retrieve and verify the peer certificate chain.

------------------------------------------------------------------------
r330 | joe | 2004-10-24 16:50:33 +0100 (Sun, 24 Oct 2004) | 7 lines

* src/ne_gnutls.c (ne__negotiate_ssl): Mark pointers as const, prepare for
doing cert verification.
(ne_ssl_context_trustcert): Implement.
(pkcs12_parse): Don't try and determine encryptedness here.
(ne_ssl_clicert_read): Verify the MAC using an empty password.
(ne_ssl_clicert_decrypt): Verify the MAC using the given password.

------------------------------------------------------------------------
r329 | joe | 2004-10-24 15:46:32 +0100 (Sun, 24 Oct 2004) | 2 lines

* src/ne_gnutls.c (pkcs12_parse): Fix GCC warnings from unhandled enum fields.

------------------------------------------------------------------------
r328 | joe | 2004-10-24 13:55:14 +0100 (Sun, 24 Oct 2004) | 9 lines

Based on patch from Aleix Conchillo Flaque:

* src/ne_gnutls.c (ne_ssl_clicert_free): Conditionally free the pkey,
subject fields.
(x509_crt_copy): New function.
(dup_client_cert): Fix memory handling.
(pkcs12_parse): Take pointers to pkey, crt, name.
(ne_ssl_clicert_read, ne_ssl_clicert_decrypt): Adjust accordingly.

------------------------------------------------------------------------
r327 | joe | 2004-10-22 09:41:46 +0100 (Fri, 22 Oct 2004) | 6 lines

From Aleix Conchillo Flaque:

* src/ne_gnutls.c (ne_ssl_context_trustcert): Implement pending
GnuTLS fix.
(pkcs12_parse): Fix certificate handling.

------------------------------------------------------------------------
r326 | joe | 2004-10-20 07:17:34 +0100 (Wed, 20 Oct 2004) | 6 lines

PKCS#12 support for GnuTLS interface from Aleix Conchillo Flaque:

* src/ne_gnutls.c (ne_ssl_clicert_free, dup_client_cert,
ne_ssl_clicert_read, ne_ssl_clicert_encrypted, ne_ssl_clicert_decrypt,
ne_ssl_clicert_owner, ne_ssl_clicert_owner, pkcs12_parse): New functions.

------------------------------------------------------------------------
r325 | joe | 2004-10-19 13:39:34 +0100 (Tue, 19 Oct 2004) | 8 lines

* src/ne_xml.c (invalid_ncname): Factor out macro for NCName
checking.
(declare_nspaces): Use invalid_ncname macro.  Don't compare 'xmlns'
case-insensitively.
(expand_qname): Use invalid_ncname macro.

* test/xml.c (fail_match): Skip correct checks for the time being.

------------------------------------------------------------------------
r324 | joe | 2004-10-17 21:32:44 +0100 (Sun, 17 Oct 2004) | 7 lines

* src/ne_gnutls.c (oid_find_highest_index): New function.
(append_rdn): Use oid_find_highest_index to find all RDNs using given
OID.
(ne_ssl_readable_dname): Add #if'd out better code which can be used
once GnuTLS bugs are fixed.
(check_identity): Use oid_find_highest_index.

------------------------------------------------------------------------
r323 | joe | 2004-10-17 21:07:29 +0100 (Sun, 17 Oct 2004) | 7 lines

* test/openssl.conf [reqDN.twoOU]: New section.

* test/makekeys.sh: Produce a twoou.cert certificate with two OU fields.

* test/ssl.c (dname_readable): Test for printing of certificate with
two OU fields.

------------------------------------------------------------------------
r322 | joe | 2004-10-17 19:18:20 +0100 (Sun, 17 Oct 2004) | 8 lines

* test/utils.c (serve_infinite): Move from props.c

* test/props.c (serve_infinite): Remove function.

* test/request.c (serve_infinite_folds, serve_infinite_headers):
Remove functions.  (unbounded_headers, unbounded_folding): Adjust to
use serve_infinite.

------------------------------------------------------------------------
r321 | joe | 2004-10-17 19:08:55 +0100 (Sun, 17 Oct 2004) | 3 lines

* src/ne_request.c (debug_dump_request): Revert part of previous
change: only print unsanitized request to debug channel by default.

------------------------------------------------------------------------
r320 | joe | 2004-10-17 19:07:06 +0100 (Sun, 17 Oct 2004) | 3 lines

* src/ne_request.c (debug_dump_request): Only jump through
request-sanitization debug hoops if really necessary.

------------------------------------------------------------------------
r319 | joe | 2004-10-17 18:58:31 +0100 (Sun, 17 Oct 2004) | 4 lines

* src/ne_request.c (read_response_block): Update comments, style.
Remove unnecessary early return for zero-length chunk.  No functional
changes.

------------------------------------------------------------------------
r318 | joe | 2004-10-17 18:22:22 +0100 (Sun, 17 Oct 2004) | 1 line

Fix typo.
------------------------------------------------------------------------
r317 | joe | 2004-10-17 18:19:37 +0100 (Sun, 17 Oct 2004) | 10 lines

Prevent memory exhaustion in PROPFIND response parsing by a hostile
server:

* src/ne_props.c (struct ne_prop_result_set): Add counter field.
(start_propstat, start_prop): Enforce a limit of 1024 properties per
resource.

* test/props.c (serve_infinite, unbounded_response,
unbounded_propstats, unbounded_props): New functions.

------------------------------------------------------------------------
r316 | joe | 2004-10-17 18:06:22 +0100 (Sun, 17 Oct 2004) | 5 lines

* src/ne_207.h (ne_207_start_propstat): Specify that a NULL return
value means that the parse is aborted.

* src/ne_207.c (start_element): Abort parsing as above.

------------------------------------------------------------------------
r315 | joe | 2004-10-17 14:06:00 +0100 (Sun, 17 Oct 2004) | 10 lines

* src/ne_xml.h (ne_xml_parse): Returns an error if parsing fails.
(ne_xml_failed): Redefine in terms of ne_xml_parse return value.

* src/ne_xml.c (ne_xml_parse): Return p->failure.  (ne_xml_parse_v):
Pass through return value from ne_xml_parse.

* test/xml.c (parse_match): Check ne_xml_parse() return value; handle
match_chunked test mode.
(matches): Test for UTF-8 BOM handling in chunked mode.

------------------------------------------------------------------------
r314 | joe | 2004-10-17 13:59:26 +0100 (Sun, 17 Oct 2004) | 2 lines

* doc/ref/iaddr.xml: Document ne_iaddr_typeof.

------------------------------------------------------------------------
r313 | joe | 2004-10-17 13:53:52 +0100 (Sun, 17 Oct 2004) | 2 lines

* src/ne_socket.h: Docs tweaks.

------------------------------------------------------------------------
r312 | joe | 2004-10-17 13:22:07 +0100 (Sun, 17 Oct 2004) | 7 lines

* src/ne_request.c (read_response_block): Document to always close the
connection on error.  (ne_read_response_block): Close the connection
if the reader callback fails.

* test/request.c (abort_reader): Check that the connection is closed
if after the abort.

------------------------------------------------------------------------
r311 | joe | 2004-10-14 21:26:59 +0100 (Thu, 14 Oct 2004) | 3 lines

* INSTALL.win32, neon.mak: Update to support ENABLE_IPV6 flag. (Kai
Sommerfeld).

------------------------------------------------------------------------
r310 | joe | 2004-10-14 13:11:30 +0100 (Thu, 14 Oct 2004) | 4 lines

* src/ne_socket.c: Include ws2tcpip.h if USE_GETADDRINFO is defined
(Kai Sommerfeld).  (ne_iaddr_print): Use getnameinfo/NI_NUMERICHOST if
inet_ntop is not available.

------------------------------------------------------------------------
r308 | joe | 2004-10-11 20:59:58 +0100 (Mon, 11 Oct 2004) | 21 lines

Allow response body callbacks to return an error:

* src/ne_request.h (ne_block_reader): Return error code.

* src/ne_request.c (ne_read_response_block): Fail with -1 if a reader
callback returns an error.

* src/ne_xml.c (ne_xml_parse_v): Return 0 (for the moment).

* src/ne_basic.c (get_to_fd): Return error.

* src/ne_compress.c (gz_reader): Return 0 (mostly), or pass through.

* src/ne_auth.c (auth_body_reader): Return 0.

* test/compress.c (reader): Return error.

* test/request.c (collector): Return 0.
(abortive_reader, abort_reader): New functions.


------------------------------------------------------------------------
r307 | joe | 2004-10-10 22:11:54 +0100 (Sun, 10 Oct 2004) | 4 lines

* src/Makefile.in: Pick up top_builddir from autoconf.

* configure.in: Let autoconf define top_builddir.

------------------------------------------------------------------------
r303 | joe | 2004-10-10 21:47:06 +0100 (Sun, 10 Oct 2004) | 9 lines

* src/ne_openssl.c (check_identity): Only match iPAddress names
against the hostname used for the session rather than the server IP
address.
(check_certificate, populate_cert): Update callers.

* test/ssl.c (fail_ssl_request): Take hostname argument, update
callers.
(fail_host_ipaltname): New test.

------------------------------------------------------------------------
r302 | joe | 2004-10-10 18:44:56 +0100 (Sun, 10 Oct 2004) | 2 lines

* Makefile.in (distclean): Remove neon.pc.

------------------------------------------------------------------------
r301 | joe | 2004-10-09 11:38:46 +0100 (Sat, 09 Oct 2004) | 3 lines

* src/ne_stubssl.c (ne_ssl_context_create): Take mode argument.
(ne_ssl_context_set_verify): New function.

------------------------------------------------------------------------
r300 | joe | 2004-10-08 15:07:26 +0100 (Fri, 08 Oct 2004) | 4 lines

* tests/common/tests.c (main): Print XFAIL in reverse video so it
stands out better, and use a white foreground for SKIPPED so it's
readable.

------------------------------------------------------------------------
r299 | joe | 2004-10-08 08:14:45 +0100 (Fri, 08 Oct 2004) | 2 lines

Compress THANKS, update copyright in README and AUTHORS.

------------------------------------------------------------------------
r298 | joe | 2004-10-07 21:25:00 +0100 (Thu, 07 Oct 2004) | 6 lines

* test/ssl.c (fail_bad_ipaltname): New function.

* test/openssl.conf, test/makekeys.sh: Create altname6.cert. Correct
altname5.cert to have a bad CN field to prevent false positives if
ipAddress altnames are not handled.

------------------------------------------------------------------------
r297 | joe | 2004-10-07 20:22:56 +0100 (Thu, 07 Oct 2004) | 4 lines

* src/ne_gnutls.c (read_to_datum): New function.
(mmap_file, munmap_file): Remove functions.
(ne_ssl_cert_read): Use read_to_datum.

------------------------------------------------------------------------
r296 | joe | 2004-10-07 14:47:20 +0100 (Thu, 07 Oct 2004) | 3 lines

* macros/neon.m4 (NEON_GSSAPI): Support --without-gssapi flag to
disable Negotiate support.

------------------------------------------------------------------------
r295 | joe | 2004-10-07 13:57:44 +0100 (Thu, 07 Oct 2004) | 12 lines

* src/ne_gnutls.c (struct ne_ssl_dname_s): Reference the cert and
subject/issuer flag.  (append_rdn): New function.
(ne_ssl_readable_dname): Reimplement to generate dname on the fly,
using append_rdn.
(ne_ssl_dname_cmp): Break.
(check_identity): Check against commonName correctly.
(ne_ssl_cert_write, ne_ssl_cert_export, ne_ssl_cert_digest):
Remove unused variables.
(populate_cert): Populate new dn structures correctly.
(ne_ssl_cert_free): Don't free dnames.
(ne_ssl_cert_import): Fix memory leak.

------------------------------------------------------------------------
r294 | joe | 2004-10-07 11:47:28 +0100 (Thu, 07 Oct 2004) | 2 lines

* test/ssl.c (ccert_unencrypted): Fail if ne_ssl_clicert_read returns NULL.

------------------------------------------------------------------------
r293 | joe | 2004-10-07 08:13:54 +0100 (Thu, 07 Oct 2004) | 3 lines

* src/ne_gnutls.c (ne_ssl_cert_import): Fix to import as DER not PEM.
(ne_ssl_cert_export): Handle arbitrary length certificates.

------------------------------------------------------------------------
r292 | joe | 2004-10-07 08:06:20 +0100 (Thu, 07 Oct 2004) | 6 lines

GNU TLS updates from Aleix:

* src/ne_gnutls.c (match_hostname, check_identity): New functions.
(ne_ssl_cert_cmp, ne_ssl_cert_digest): Simplify.
(x509_get_dn): Fix buffer length handling.

------------------------------------------------------------------------
r291 | joe | 2004-10-07 08:00:15 +0100 (Thu, 07 Oct 2004) | 10 lines

* src/ne_ssl.h (ne_ssl_context_set_verify): New function.
(ne_ssl_context_create): Change flags argument to 'mode'.

* src/ne_openssl.c (ne_ssl_context_create): Update to handle modes.
(ne_ssl_context_set_verify): Implement.

* src/ne_gnutls.c (ne_ssl_cert_validity): Fix date format and
use correct buffers.
(ne_ssl_context_set_verify): Implement.

------------------------------------------------------------------------
r290 | joe | 2004-10-06 22:46:01 +0100 (Wed, 06 Oct 2004) | 2 lines

* test/socket.c: Remove OpenSSL includes (Aleix).

------------------------------------------------------------------------
r289 | joe | 2004-10-06 12:16:58 +0100 (Wed, 06 Oct 2004) | 8 lines

Fix slow startup problems with GNU TLS:

* src/ne_privssl.h (struct ne_ssl_context_s) [HAVE_GNUTLS]: Remove
_params fields.

* src/ne_gnutls.c (ne_ssl_context_create, ne_ssl_context_destroy):
Don't generate temporary RSA keys or DH paramaters.

------------------------------------------------------------------------
r288 | joe | 2004-10-06 11:58:53 +0100 (Wed, 06 Oct 2004) | 3 lines

* src/ne_socket.c (ne_sock_accept_ssl) [HAVE_OPENSSL]: Fix to return 0
for SSL_accept() success.

------------------------------------------------------------------------
r287 | joe | 2004-10-06 11:22:57 +0100 (Wed, 06 Oct 2004) | 3 lines

* test/socket.c (read_reset, write_reset, line_closure, ssl_closure):
Print socket error string for failure cases.

------------------------------------------------------------------------
r286 | joe | 2004-10-06 11:16:58 +0100 (Wed, 06 Oct 2004) | 2 lines

* src/ne_socket.c (read_gnutls): Return NE_SOCK_CLOSED on EOF.

------------------------------------------------------------------------
r285 | joe | 2004-10-06 09:43:05 +0100 (Wed, 06 Oct 2004) | 8 lines

Fix write handling with GNU TLS:

* src/ne_socket.c (struct iofns): Redefine write semantics to allow
short writes.
(write_raw): Drop short write handling, return bytes written.
(write_ossl, write_gnutls): Return bytes written.
(ne_sock_fullwrite): Handle short writes here.

------------------------------------------------------------------------
r284 | joe | 2004-10-06 09:30:48 +0100 (Wed, 06 Oct 2004) | 31 lines

Simplify and extend abstraction of SSL layer:

* src/ne_privssl.h: Make ne_ssl_socket a typedef.
[HAVE_GNUTLS]: Remove union cred, gnutls_session pointer.
(ne__sock_sslsock): Add prototype.

* src/ne_socket.h (ne_sock_accept_ssl): Replaces ne_sock_switch_ssl.
Remove ne_sock_sslsock prototype.

* src/ne_socket.c: Include ne_privssl.h later.
(readable_ossl, error_ossl, write_ossl, readable_gnutls, error_gnutls,
read_gnutls, write_gnutls, ne_sock_connect_ssl): Adjust for
ne_ssl_socket change.  (ne__sock_sslsock): Rename from
ne_sock_sslsock.  (ne_sock_accept_ssl): New function.
(ne_sock_switch_ssl): Remove function.

* src/ne_ssl.h (ne_ssl_context_create): Take flags argument.
(ne_ssl_context_keypair): New prototype.
(ne_ssl_context_trustcert): Renamed from ne_ssl_ctx_trustcert.

* src/ne_openssl.c (ne_ssl_context_create): Take flags.
(ne_ssl_context_keypair): Implement.
(ne__negotiate_ssl): Adjust to use ne__sock_sslsock.

* src/ne_gnutls.c (ne_ssl_context_create): Take flags, adjust
for ctx->cred change.
(ne_ssl_context_keypair): Implement.

* test/socket.c (init_ssl): Switch to use ne_ssl_context for the
server context rather than OpenSSL directly.

------------------------------------------------------------------------
r283 | joe | 2004-10-06 09:15:30 +0100 (Wed, 06 Oct 2004) | 2 lines

* src/Makefile.in: Add deps for ne_gnutls.lo.

------------------------------------------------------------------------
r282 | joe | 2004-10-05 21:50:01 +0100 (Tue, 05 Oct 2004) | 3 lines

* test/socket.c (serve_reset): New function.
(write_reset, read_reset): Use it.

------------------------------------------------------------------------
r281 | joe | 2004-10-05 21:22:35 +0100 (Tue, 05 Oct 2004) | 1 line

Suffer the aclocal noise for the time being.
------------------------------------------------------------------------
r280 | joe | 2004-10-05 21:21:40 +0100 (Tue, 05 Oct 2004) | 11 lines

Continued work on GNU TLS support, from Aleix Conchillo Flaque:

* src/ne_gnutls.c (ne__negotiate_ssl): Rename from ne_negotiate_ssl.

* src/ne_socket.c [HAVE_GNUTLS] (init_ssl): Call gnutls_global_init.
(ne_sock_exit): Call gnutls_global_deinit.
(check_alert, readable_gnutls, error_gnutls, read_gnutls, write_gnutls):
New functions.
(ne_sock_switch_ssl, ne_sock_connect_ssl, ne_sock_close): Add GNU TLS
specific implementations.

------------------------------------------------------------------------
r279 | joe | 2004-10-05 21:12:19 +0100 (Tue, 05 Oct 2004) | 6 lines

CygWin fixes:

* src/ne_socket.c (NE_ISRESET): Treat ECONNABORTED like ECONNRESET.
(ne_sock_connect): Don't compare fd numbers to FD_SETSIZE on Win32, do
use ne_close().

------------------------------------------------------------------------
r275 | joe | 2004-10-04 22:46:13 +0100 (Mon, 04 Oct 2004) | 6 lines

* src/ne_request.c (ne_begin_request): Don't treat 205 like 204, per
http-wg clarification:
http://lists.w3.org/Archives/Public/ietf-http-wg/2004JulSep/0081.html

* test/request.c (no_body_205): Remove test.

------------------------------------------------------------------------
r274 | joe | 2004-10-04 22:20:31 +0100 (Mon, 04 Oct 2004) | 17 lines

Begin integration of GNU TLS support from Aleix Conchillo Flaque:

* macros/neon.m4 (NE_CHECK_OPENSSLVER): Renamed from NE_CHECK_SSLVER.
(NEON_SSL): Add detection support for GNU TLS.  Define HAVE_GNUTLS or
HAVE_OPENSSL as appropriate.

* src/ne_utils.c (version_string): Update to include GNU TLS version
string.

* src/ne_privssl.h (HAVE_GNUTLS): Add alternative private structure
definitions.

* src/ne_auth.c (get_cnonce): Adjust to use HAVE_OPENSSL rather than
NE_HAVE_SSL.

* src/ne_gnutls.c: New file.

------------------------------------------------------------------------
r273 | joe | 2004-10-04 21:56:57 +0100 (Mon, 04 Oct 2004) | 3 lines

* src/ne_socket.c (ne_sock_connect): Use htons not ntohs (Aleix
Conchillo Flaque).

------------------------------------------------------------------------
r270 | joe | 2004-10-02 23:26:42 +0100 (Sat, 02 Oct 2004) | 1 line

Add clog to svn:ignore.
------------------------------------------------------------------------
r269 | joe | 2004-10-02 23:25:13 +0100 (Sat, 02 Oct 2004) | 7 lines

Merge r266, r267 from 0.24.x branch:

* config.hw.in: Define HAVE_SETSOCKOPT to enable Nagle on Windows.

* macros/neon.m4: Check for socket() in ws2_32 for CygWin.


------------------------------------------------------------------------
r268 | joe | 2004-10-02 23:19:52 +0100 (Sat, 02 Oct 2004) | 1 line

Convert .cvsignore to svn:ignore.
------------------------------------------------------------------------
r256 | joe | 2004-10-02 20:38:59 +0100 (Sat, 02 Oct 2004) | 1 line

Merge trunk up to current neon CVS HEAD.
------------------------------------------------------------------------
r255 | joe | 2004-10-02 20:34:48 +0100 (Sat, 02 Oct 2004) | 1 line

Branch trunk from 0.24.4 on 0.24.x branch.
------------------------------------------------------------------------
r251 | joe | 2004-10-02 20:31:06 +0100 (Sat, 02 Oct 2004) | 1 line

Import neon-0.24.4.
------------------------------------------------------------------------
r249 | joe | 2004-10-02 20:29:59 +0100 (Sat, 02 Oct 2004) | 1 line

Import neon-0.24.3.
------------------------------------------------------------------------
r247 | joe | 2004-10-02 20:25:57 +0100 (Sat, 02 Oct 2004) | 1 line

Import neon-0.24.2.
------------------------------------------------------------------------
r244 | joe | 2004-10-02 20:15:53 +0100 (Sat, 02 Oct 2004) | 1 line

Import neon-0.24.1.
------------------------------------------------------------------------
r243 | joe | 2004-10-02 19:47:02 +0100 (Sat, 02 Oct 2004) | 2 lines

Import neon 0.24.0 to begin 0.24.x branch.

------------------------------------------------------------------------
